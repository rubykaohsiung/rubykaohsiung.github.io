<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Active Support 儀器 — Ruby on Rails Guides</title>
  <link rel="stylesheet" type="text/css" href="stylesheets/style.css" data-turbolinks-track="reload">
  <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
  <link rel="stylesheet" type="text/css" href="stylesheets/highlight.css" data-turbolinks-track="reload">
  <link href="images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
  <script src="javascripts/turbolinks.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/clipboard.js" data-turbolinks-track="reload"></script>
  <script src="javascripts/guides.js" data-turbolinks-track="reload"></script>
  <meta property="og:title" content="Active Support 儀器 — Ruby on Rails Guides" />
  <meta name="description" content="Active Support 儀器active support 是核心 rails 的一部分，它提供 Ruby 語言擴充套件、實用程式和其他東西。它包含的其中一項內容是檢測 api，可在應用程式內部使用該 api 來測量 Ruby 程式碼中出現的某些 action，例如 rails 應用程式或框架本身內部的 action。然而，它不僅限於導軌。如果需要，它可以在其他Ruby 指令碼中獨立使用。在本指南中，您將學習如何使用 active support 內部的檢測 api 來測量 rails 和其他 Ruby 程式碼內部的事件。閱讀本指南後，您將瞭解： 什麼儀器可以提供。 如何向鉤子新增訂閱者。 用於檢測的 Rails 框架內的鉤子。 如何構建自定義檢測實現。" />
  <meta property="og:description" content="Active Support 儀器active support 是核心 rails 的一部分，它提供 Ruby 語言擴充套件、實用程式和其他東西。它包含的其中一項內容是檢測 api，可在應用程式內部使用該 api 來測量 Ruby 程式碼中出現的某些 action，例如 rails 應用程式或框架本身內部的 action。然而，它不僅限於導軌。如果需要，它可以在其他Ruby 指令碼中獨立使用。在本指南中，您將學習如何使用 active support 內部的檢測 api 來測量 rails 和其他 Ruby 程式碼內部的事件。閱讀本指南後，您將瞭解： 什麼儀器可以提供。 如何向鉤子新增訂閱者。 用於檢測的 Rails 框架內的鉤子。 如何構建自定義檢測實現。" />
  <meta property="og:locale" content="en_US" />
  <meta property="og:site_name" content="Ruby on Rails Guides" />
  <meta property="og:image" content="https://avatars.githubusercontent.com/u/4223" />
  <meta property="og:type" content="website" />
</head>
<body class="guide">
  <div>
    <div id="version-badge">v6.1.4</div>
  </div>
  <div id="topNav">
    <div class="wrapper">
      <strong class="more-info-label">更多訊息請訪問 <a href="https://rubyonrails.org/">rubyonrails.org：</a> </strong>
      <span class="red-button more-info-button">
        更多 Ruby on Rails
      </span>
      <ul class="more-info-links s-hidden">
        <li class="more-info"><a href="https://weblog.rubyonrails.org/">部落格</a></li>
        <li class="more-info"><a href="https://guides.rubyonrails.org/">指南</a></li>
        <li class="more-info"><a href="https://api.rubyonrails.org/">API</a></li>
        <li class="more-info"><a href="https://discuss.rubyonrails.org/">論壇</a></li>
        <li class="more-info"><a href="https://github.com/rails/rails">在 GitHub 上做出貢獻</a></li>
      </ul>
    </div>
  </div>
  <div id="header">
    <div class="wrapper clearfix">
      <h1><a href="index.html" title="返回首頁">Guides.rubyonrails.org</a></h1>
      <ul class="nav">
        <li><a class="nav-item" href="index.html">首頁</a></li>
        <li class="guides-index guides-index-large">
          <a href="index.html" id="guidesMenu" class="guides-index-item nav-item">指南索引</a>
          <div id="guides" class="clearfix" style="display: none;">
            <hr />
            <dl class="guides-section-container">
                <div class="guides-section">
                  <dt>從這裡開始</dt>
                  <dd><a href="getting_started.html">Rails 入門</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Models</dt>
                  <dd><a href="active_record_basics.html">Active Record 基礎知識</a></dd>
                  <dd><a href="active_record_migrations.html">Active Record Migrations</a></dd>
                  <dd><a href="active_record_validations.html">Active Record 驗證</a></dd>
                  <dd><a href="active_record_callbacks.html">Active Record Callbacks</a></dd>
                  <dd><a href="association_basics.html">Active Record Associations</a></dd>
                  <dd><a href="active_record_querying.html">Active Record 查詢介面</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Views</dt>
                  <dd><a href="layouts_and_rendering.html">Rails 中的佈局和渲染</a></dd>
                  <dd><a href="form_helpers.html">Action View 表單 Helpers</a></dd>
                </div>
                <div class="guides-section">
                  <dt>Controllers</dt>
                  <dd><a href="action_controller_overview.html">Action Controller結束view</a></dd>
                  <dd><a href="routing.html">Rails 從外到內路由</a></dd>
                </div>
                <div class="guides-section">
                  <dt>其他元件</dt>
                  <dd><a href="active_support_core_extensions.html">Active Support 核心擴充套件</a></dd>
                  <dd><a href="action_mailer_basics.html">Action Mailer 基礎知識</a></dd>
                  <dd><a href="active_job_basics.html">現役工作基礎</a></dd>
                  <dd><a href="active_storage_overview.html">Active Storage 結束view</a></dd>
                  <dd><a href="action_cable_overview.html">Action Cable 結束 view</a></dd>
                  <dd><a href="webpacker.html">打包機</a></dd>
                </div>
                <div class="guides-section">
                  <dt>深層發掘</dt>
                  <dd><a href="i18n.html">Rails 國際化 (I18n) API</a></dd>
                  <dd><a href="testing.html">測試 Rails 應用程式</a></dd>
                  <dd><a href="security.html">保護 Rails 應用程式</a></dd>
                  <dd><a href="debugging_rails_applications.html">除錯 Rails 應用程式</a></dd>
                  <dd><a href="configuring.html">配置 Rails 應用程式</a></dd>
                  <dd><a href="command_line.html">Rails 命令列</a></dd>
                  <dd><a href="asset_pipeline.html">Asset Pipeline</a></dd>
                  <dd><a href="autoloading_and_reloading_constants.html">自動載入和重新載入常量</a></dd>
                  <dd><a href="caching_with_rails.html">使用 Rails 快取：結束view</a></dd>
                  <dd><a href="api_app.html">將 Rails 用於僅 API 的應用程式</a></dd>
                </div>
                <div class="guides-section">
                  <dt>延伸導軌</dt>
                  <dd><a href="rails_on_rack.html">機架上的導軌</a></dd>
                  <dd><a href="generators.html">建立和自定義 Rails 生成器和模板</a></dd>
                </div>
                <div class="guides-section">
                  <dt>貢獻</dt>
                  <dd><a href="contributing_to_ruby_on_rails.html">在 Rails 上為 Ruby 做貢獻</a></dd>
                  <dd><a href="api_documentation_guidelines.html">API 文件指南</a></dd>
                  <dd><a href="ruby_on_rails_guides_guidelines.html">指南指南</a></dd>
                </div>
                <div class="guides-section">
                  <dt>政策</dt>
                  <dd><a href="maintenance_policy.html">維修政策</a></dd>
                </div>
                <div class="guides-section">
                  <dt>發行說明</dt>
                  <dd><a href="upgrading_ruby_on_rails.html">在 Rails 上升級 Ruby</a></dd>
                  <dd><a href="6_1_release_notes.html">版本 6.1 - 2020 年 12 月</a></dd>
                  <dd><a href="6_0_release_notes.html">6.0 版 - 2019 年 8 月</a></dd>
                  <dd><a href="5_2_release_notes.html">5.2 版 - 2018 年 4 月</a></dd>
                  <dd><a href="5_1_release_notes.html">5.1 版 - 2017 年 4 月</a></dd>
                  <dd><a href="5_0_release_notes.html">5.0 版 - 2016 年 6 月</a></dd>
                  <dd><a href="4_2_release_notes.html">4.2 版 - 2014 年 12 月</a></dd>
                  <dd><a href="4_1_release_notes.html">4.1 版 - 2014 年 4 月</a></dd>
                  <dd><a href="4_0_release_notes.html">4.0 版 - 2013 年 6 月</a></dd>
                  <dd><a href="3_2_release_notes.html">3.2 版 - 2012 年 1 月</a></dd>
                  <dd><a href="3_1_release_notes.html">3.1 版 - 2011 年 8 月</a></dd>
                  <dd><a href="3_0_release_notes.html">3.0 版 - 2010 年 8 月</a></dd>
                  <dd><a href="2_3_release_notes.html">2.3 版 - 2009 年 3 月</a></dd>
                  <dd><a href="2_2_release_notes.html">2.2 版 - 2008 年 11 月</a></dd>
                </div>
            </dl>
          </div>
        </li>
        <li><a class="nav-item" href="contributing_to_ruby_on_rails.html">貢獻</a></li>
        <li class="guides-index guides-index-small">
          <select class="guides-index-item nav-item">
            <option value="index.html">指南索引</option>
              <optgroup label="從這裡開始">
                  <option value="getting_started.html">Rails 入門</option>
              </optgroup>
              <optgroup label="Models">
                  <option value="active_record_basics.html">Active Record 基礎知識</option>
                  <option value="active_record_migrations.html">Active Record Migrations</option>
                  <option value="active_record_validations.html">Active Record 驗證</option>
                  <option value="active_record_callbacks.html">Active Record Callbacks</option>
                  <option value="association_basics.html">Active Record Associations</option>
                  <option value="active_record_querying.html">Active Record 查詢介面</option>
              </optgroup>
              <optgroup label="Views">
                  <option value="layouts_and_rendering.html">Rails 中的佈局和渲染</option>
                  <option value="form_helpers.html">Action View 表單 Helpers</option>
              </optgroup>
              <optgroup label="Controllers">
                  <option value="action_controller_overview.html">Action Controller結束view</option>
                  <option value="routing.html">Rails 從外到內路由</option>
              </optgroup>
              <optgroup label="其他元件">
                  <option value="active_support_core_extensions.html">Active Support 核心擴充套件</option>
                  <option value="action_mailer_basics.html">Action Mailer 基礎知識</option>
                  <option value="active_job_basics.html">現役工作基礎</option>
                  <option value="active_storage_overview.html">Active Storage 結束view</option>
                  <option value="action_cable_overview.html">Action Cable 結束 view</option>
                  <option value="webpacker.html">打包機</option>
              </optgroup>
              <optgroup label="深層發掘">
                  <option value="i18n.html">Rails 國際化 (I18n) API</option>
                  <option value="testing.html">測試 Rails 應用程式</option>
                  <option value="security.html">保護 Rails 應用程式</option>
                  <option value="debugging_rails_applications.html">除錯 Rails 應用程式</option>
                  <option value="configuring.html">配置 Rails 應用程式</option>
                  <option value="command_line.html">Rails 命令列</option>
                  <option value="asset_pipeline.html">Asset Pipeline</option>
                  <option value="autoloading_and_reloading_constants.html">自動載入和重新載入常量</option>
                  <option value="caching_with_rails.html">使用 Rails 快取：結束view</option>
                  <option value="api_app.html">將 Rails 用於僅 API 的應用程式</option>
              </optgroup>
              <optgroup label="延伸導軌">
                  <option value="rails_on_rack.html">機架上的導軌</option>
                  <option value="generators.html">建立和自定義 Rails 生成器和模板</option>
              </optgroup>
              <optgroup label="貢獻">
                  <option value="contributing_to_ruby_on_rails.html">在 Rails 上為 Ruby 做貢獻</option>
                  <option value="api_documentation_guidelines.html">API 文件指南</option>
                  <option value="ruby_on_rails_guides_guidelines.html">指南指南</option>
              </optgroup>
              <optgroup label="政策">
                  <option value="maintenance_policy.html">維修政策</option>
              </optgroup>
              <optgroup label="發行說明">
                  <option value="upgrading_ruby_on_rails.html">在 Rails 上升級 Ruby</option>
                  <option value="6_1_release_notes.html">版本 6.1 - 2020 年 12 月</option>
                  <option value="6_0_release_notes.html">6.0 版 - 2019 年 8 月</option>
                  <option value="5_2_release_notes.html">5.2 版 - 2018 年 4 月</option>
                  <option value="5_1_release_notes.html">5.1 版 - 2017 年 4 月</option>
                  <option value="5_0_release_notes.html">5.0 版 - 2016 年 6 月</option>
                  <option value="4_2_release_notes.html">4.2 版 - 2014 年 12 月</option>
                  <option value="4_1_release_notes.html">4.1 版 - 2014 年 4 月</option>
                  <option value="4_0_release_notes.html">4.0 版 - 2013 年 6 月</option>
                  <option value="3_2_release_notes.html">3.2 版 - 2012 年 1 月</option>
                  <option value="3_1_release_notes.html">3.1 版 - 2011 年 8 月</option>
                  <option value="3_0_release_notes.html">3.0 版 - 2010 年 8 月</option>
                  <option value="2_3_release_notes.html">2.3 版 - 2009 年 3 月</option>
                  <option value="2_2_release_notes.html">2.2 版 - 2008 年 11 月</option>
              </optgroup>
          </select>
        </li>
      </ul>
    </div>
  </div>
  <hr class="hide" />

  <div id="feature">
    <div class="wrapper">
      <h2>Active Support 儀器</h2><p>active support 是核心 rails 的一部分，它提供 Ruby 語言擴充套件、實用程式和其他東西。它包含的其中一項內容是檢測 api，可在應用程式內部使用該 api 來測量 Ruby 程式碼中出現的某些 action，例如 rails 應用程式或框架本身內部的 action。然而，它不僅限於導軌。如果需要，它可以在其他Ruby 指令碼中獨立使用。</p><p>在本指南中，您將學習如何使用 active support 內部的檢測 api 來測量 rails 和其他 Ruby 程式碼內部的事件。</p><p>閱讀本指南後，您將瞭解：</p>
<ul>
<li>什麼儀器可以提供。</li>
<li>如何向鉤子新增訂閱者。</li>
<li>用於檢測的 Rails 框架內的鉤子。</li>
<li>如何構建自定義檢測實現。</li>
</ul>


                <div id="subCol">
            <h3 class="chapter"><img src="images/chapters_icon.gif" alt="" />Chapters</h3>
            <ol class="chapters">
<li><a href="#">儀器簡介</a></li>
<li><a href="#">訂閱事件</a></li>
<li>
<a href="#rails">Rails 框架鉤子</a>

<ul>
<li><a href="#action-controller">action controller</a></li>
<li><a href="#action">action 排程</a></li>
<li><a href="#action-view">action view</a></li>
<li><a href="#active-record">active record</a></li>
<li><a href="#action">action 郵寄者</a></li>
<li><a href="#active-support">active support</a></li>
<li><a href="#">活動作業</a></li>
<li><a href="#action">action 電纜</a></li>
<li><a href="#active-storage">active storage</a></li>
<li><a href="#railties">railties</a></li>
<li><a href="#rails">rails</a></li>
</ul>
</li>
<li><a href="#exceptions">Exceptions</a></li>
<li><a href="#creating-custom-events">Creating custom events</a></li>
</ol>

          </div>

    </div>
  </div>

  <div id="container">
    <div class="wrapper">
      <div id="mainCol">
        <h3 id=""><a class="anchorlink" href="#">1 儀器簡介</a></h3><p>active support 提供的檢測 api 允許開發人員提供其他開發人員可以掛鉤的鉤子。 <a href="#rails-framework-hooks">rails 框架</a> 中有幾個。使用此 api，開發人員可以選擇在他們的應用程式或另一段 Ruby 程式碼中發生某些事件時收到通知。</p><p>例如，active record 中提供了一個鉤子，每次active record 在資料庫上使用 sql 查詢時都會呼叫該鉤子。此鉤子可以<strong>訂閱</strong>，並用於跟蹤特定action 期間的查詢數量。處理Controller 的action 還有另一個鉤子。例如，這可用於跟蹤特定action 花費的時間。</p><p>您甚至可以在您的應用程式中<a href="#creating-custom-events">建立您自己的事件</a>，您可以稍後訂閱。</p><h3 id=""><a class="anchorlink" href="#">2 訂閱事件</a></h3><p>訂閱事件很容易。使用帶有塊的<code>ActiveSupport::Notifications.subscribe</code>
收聽任何通知。</p><p>該塊接收以下引數：</p>
<ul>
<li>事件名稱</li>
<li>開始的時間</li>
<li>完成時間</li>
<li>觸發事件的檢測器的唯一 ID</li>
<li>有效載荷（在以後的部分中描述）</li>
</ul>
<div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.subscribe "process_action.action_Controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  rails.logger.info "#{name} received! (started: #{started}, finished: #{finished})" # process_action.action_Controller received (started: 2019-05-05 13:43:57 -0800, finished: 2019-05-05 13:43:58 -0800)
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='activesupport::notifications.subscribe "process_action.action_Controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  rails.logger.info "#{name} received! (started: #{started}, finished: #{finished})" # process_action.action_Controller received (started: 2019-05-05 13:43:57 -0800, finished: 2019-05-05 13:43:58 -0800)
end
'>Copy</button>
</div>
<p>如果您擔心<code>started</code> 和<code>finished</code> 計算精確經過時間的準確性，請使用<code>ActiveSupport::Notifications.monotonic_subscribe</code>。給定的塊將接收與上述相同的引數，但“started”和“finished”將具有具有準確單調時間而不是掛鐘時間的值。</p><div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.monotonic_subscribe "process_action.action_Controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  rails.logger.info "#{name} received! (started: #{started}, finished: #{finished})" # process_action.action_Controller received (started: 1560978.425334, finished: 1560979.429234)
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='activesupport::notifications.monotonic_subscribe "process_action.action_Controller" do |name, started, finished, unique_id, data|
  # your own custom stuff
  rails.logger.info "#{name} received! (started: #{started}, finished: #{finished})" # process_action.action_Controller received (started: 1560978.425334, finished: 1560979.429234)
end
'>Copy</button>
</div>
<p>每次定義所有這些塊引數可能很乏味。您可以輕鬆建立一個<code>ActiveSupport::Notifications::Event</code>
從像這樣的塊引數：</p><div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.subscribe "process_action.action_Controller" do |*args|
  event = ActiveSupport::Notifications::Event.new *args

  event.name      # =&gt; "process_action.action_Controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='activesupport::notifications.subscribe "process_action.action_Controller" do |*args|
  event = ActiveSupport::Notifications::Event.new *args

  event.name      # =&gt; "process_action.action_Controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
'>Copy</button>
</div>
<p>你也可以傳遞一個只接受一個引數的塊，它會接收一個事件物件：</p><div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.subscribe "process_action.action_Controller" do |event|
  event.name      # =&gt; "process_action.action_Controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='activesupport::notifications.subscribe "process_action.action_Controller" do |event|
  event.name      # =&gt; "process_action.action_Controller"
  event.duration  # =&gt; 10 (in milliseconds)
  event.payload   # =&gt; {:extra=&gt;information}

  Rails.logger.info "#{event} Received!"
end
'>Copy</button>
</div>
<p>大多數時候你只關心資料本身。這是獲取資料的快捷方式。</p><div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.subscribe "process_action.action_Controller" do |*args|
  data = args.extract_options!
  data # { extra: :information }
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='activesupport::notifications.subscribe "process_action.action_Controller" do |*args|
  data = args.extract_options!
  data # { extra: :information }
end
'>Copy</button>
</div>
<p>您還可以訂閱與正則表示式匹配的事件。這使您能夠訂閱
一次多個事件。以下是從<code>actionController</code> 訂閱所有內容的方法。</p><div class="code_container">
<pre><code class="highlight plaintext">activesupport::notifications.subscribe /action_Controller/ do |*args|
  # inspect all actionController events
end
</code></pre>
<button class="clipboard-button" data-clipboard-text="activesupport::notifications.subscribe /action_Controller/ do |*args|
  # inspect all actionController events
end
">Copy</button>
</div>
<h3 id="rails"><a class="anchorlink" href="#rails">3 Rails 框架鉤子</a></h3><p>在Ruby on rails 框架中，為常見事件提供了許多鉤子。下面詳細介紹了這些。</p><h4 id="action-controller"><a class="anchorlink" href="#action-controller">3.1 action controller</a></h4><h5 id="write-fragment-action-controller"><a class="anchorlink" href="#write-fragment-action-controller">3.1.1 write_fragment。action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>完整的鑰匙</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: 'posts/1-dashboard-View'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-View'
}
">Copy</button>
</div>
<h5 id="read-fragment-action-controller"><a class="anchorlink" href="#read-fragment-action-controller">3.1.2 read_fragment。action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>完整的鑰匙</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: 'posts/1-dashboard-View'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-View'
}
">Copy</button>
</div>
<h5 id="expire-fragment-action-controller"><a class="anchorlink" href="#expire-fragment-action-controller">3.1.3 expire_fragment.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>完整的鑰匙</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: 'posts/1-dashboard-View'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-View'
}
">Copy</button>
</div>
<h5 id="exist-fragment-questionmark-action-controller"><a class="anchorlink" href="#exist-fragment-questionmark-action-controller">3.1.4 exist_fragment?.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>完整的鑰匙</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: 'posts/1-dashboard-View'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  key: 'posts/1-dashboard-View'
}
">Copy</button>
</div>
<h5 id="write-page-action-controller"><a class="anchorlink" href="#write-page-action-controller">3.1.5 write_page.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:路徑</code></td>
<td>完整路徑</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  path: '/users/1'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  path: '/users/1'
}
">Copy</button>
</div>
<h5 id="expire-page-action-controller"><a class="anchorlink" href="#expire-page-action-controller">3.1.6 expire_page.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:路徑</code></td>
<td>完整路徑</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  path: '/users/1'
}
</code></pre>
<button class="clipboard-button" data-clipboard-text="{
  path: '/users/1'
}
">Copy</button>
</div>
<h5 id="start-processing-action-controller"><a class="anchorlink" href="#start-processing-action-controller">3.1.7 start_processing.action_controller</a></h5><p>|鑰匙 |價值 |
| ------------- | -------------------------------------------------- ------- |
| <code>:Controller</code> | Controller 名稱 |
| <code>:Action</code> | Action |
| <code>:引數</code> |沒有任何過濾引數的請求引數的雜湊|
| <code>:標題</code> |請求頭 |
| <code>:格式</code> | html/js/json/xml 等 |
| <code>:方法</code> | HTTP 請求動詞 |
| <code>:路徑</code> |請求路徑 |</p><div class="code_container">
<pre><code class="highlight plaintext">{
  Controller: "postsController",
  Action: "new",
  params: { "action" =&gt; "new", "Controller" =&gt; "posts" },
  headers: #&lt;Actiondispatch::http::headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts/new"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  Controller: "postsController",
  Action: "new",
  params: { "action" =&gt; "new", "Controller" =&gt; "posts" },
  headers: #&lt;Actiondispatch::http::headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts/new"
}
'>Copy</button>
</div>
<h5 id="process-action-action-controller"><a class="anchorlink" href="#process-action-action-controller">3.1.8 process_action.action_controller</a></h5><p>|鑰匙 |價值 |
| --------------- | -------------------------------------------------- ------- |
| <code>:Controller</code> | Controller 名稱 |
| <code>:Action</code> | Action |
| <code>:引數</code> |沒有任何過濾引數的請求引數的雜湊|
| <code>:標題</code> |請求頭 |
| <code>:格式</code> | html/js/json/xml 等 |
| <code>:方法</code> | HTTP 請求動詞 |
| <code>:路徑</code> |請求路徑 |
| <code>:請求</code> | <code>Actiondispatch::request</code> |
| <code>:響應</code> | <code>Actiondispatch::response</code> |
| <code>:狀態</code> | HTTP 狀態碼 |
| <code>:View_runtime</code> |在View 中花費的金額（以毫秒為單位） |
| <code>:db_runtime</code> |以毫秒為單位執行資料庫查詢所花費的金額 |</p><div class="code_container">
<pre><code class="highlight plaintext">{
  Controller: "postsController",
  Action: "index",
  params: {"action" =&gt; "index", "Controller" =&gt; "posts"},
  headers: #&lt;Actiondispatch::http::headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts",
  request: #&lt;Actiondispatch::request:0x00007ff1cb9bd7b8&gt;,
  response: #&lt;Actiondispatch::response:0x00007f8521841ec8&gt;,
  status: 200,
  View_runtime: 46.848,
  db_runtime: 0.157
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  Controller: "postsController",
  Action: "index",
  params: {"action" =&gt; "index", "Controller" =&gt; "posts"},
  headers: #&lt;Actiondispatch::http::headers:0x0055a67a519b88&gt;,
  format: :html,
  method: "GET",
  path: "/posts",
  request: #&lt;Actiondispatch::request:0x00007ff1cb9bd7b8&gt;,
  response: #&lt;Actiondispatch::response:0x00007f8521841ec8&gt;,
  status: 200,
  View_runtime: 46.848,
  db_runtime: 0.157
}
'>Copy</button>
</div>
<h5 id="send-file-action-controller"><a class="anchorlink" href="#send-file-action-controller">3.1.9 send_file.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:路徑</code></td>
<td>檔案的完整路徑</td>
</tr>
</tbody>
</table>
<p>資訊。呼叫者可以新增額外的鍵。</p><h5 id="send-data-action-controller"><a class="anchorlink" href="#send-data-action-controller">3.1.10 send_data.action_controller</a></h5><p><code>actionController</code> 不會向負載新增任何特定資訊。所有選項都傳遞給有效負載。</p><h5 id="redirect-to-action-controller"><a class="anchorlink" href="#redirect-to-action-controller">3.1.11 redirect_to.action_controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:狀態</code></td>
<td>HTTP 響應程式碼</td>
</tr>
<tr>
<td><code>:位置</code></td>
<td>重定向到的 URL</td>
</tr>
<tr>
<td><code>:請求</code></td>
<td><code>Actiondispatch::request</code></td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  status: 302,
  location: "http://localhost:3000/posts/new",
  request: #&lt;Actiondispatch::request:0x00007ff1cb9bd7b8&gt;
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  status: 302,
  location: "http://localhost:3000/posts/new",
  request: #&lt;Actiondispatch::request:0x00007ff1cb9bd7b8&gt;
}
'>Copy</button>
</div>
<h5 id="callback-actioncontroller"><a class="anchorlink" href="#callback-actioncontroller">3.1.12 暫停<em>callback。action</em>controller</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:過濾器</code></td>
<td>停止Action</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  filter: ":halting_filter"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  filter: ":halting_filter"
}
'>Copy</button>
</div>
<h5 id="unpermitted-pa-rameters-action-controller"><a class="anchorlink" href="#unpermitted-pa-rameters-action-controller">3.1.13 unpermitted_pa​​rameters。action_controller</a></h5><p>|鑰匙 |價值 |
| ------------- | -------------------------------------------------- ------------------- |
| <code>:keys</code> |未經許可的金鑰 |
| <code>:上下文</code> |使用以下鍵雜湊：:Controller, :action, :params, :request |</p><h4 id="action"><a class="anchorlink" href="#action">3.2 action 排程</a></h4><h5 id="process-middleware-action-dispatch"><a class="anchorlink" href="#process-middleware-action-dispatch">3.2.1 process_middleware。action_dispatch</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:中介軟體</code></td>
<td>中介軟體名稱</td>
</tr>
</tbody>
</table>
<h4 id="action-view"><a class="anchorlink" href="#action-view">3.3 action view</a></h4><h5 id="render-template-action-view"><a class="anchorlink" href="#render-template-action-view">3.3.1 render_template.action_view</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:識別符號</code></td>
<td>模板的完整路徑</td>
</tr>
<tr>
<td><code>:佈局</code></td>
<td>適用佈局</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  identifier: "/users/adam/projects/notifications/app/Views/posts/index.html.erb",
  layout: "layouts/application"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/users/adam/projects/notifications/app/Views/posts/index.html.erb",
  layout: "layouts/application"
}
'>Copy</button>
</div>
<h5 id="render-partial-action-view"><a class="anchorlink" href="#render-partial-action-view">3.3.2 render_partial。action_view</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:識別符號</code></td>
<td>模板的完整路徑</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  identifier: "/users/adam/projects/notifications/app/Views/posts/_form.html.erb"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/users/adam/projects/notifications/app/Views/posts/_form.html.erb"
}
'>Copy</button>
</div>
<h5 id="render-collection-action-view"><a class="anchorlink" href="#render-collection-action-view">3.3.3 render_collection。action_view</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:識別符號</code></td>
<td>模板的完整路徑</td>
</tr>
<tr>
<td><code>:計數</code></td>
<td>收藏尺寸</td>
</tr>
<tr>
<td><code>:cache_hits</code></td>
<td>從快取中獲取的部分數</td>
</tr>
</tbody>
</table>
<p><code>:cache_hits</code> 僅在集合使用 <code>cached: true</code> 呈現時才包含在內。</p><div class="code_container">
<pre><code class="highlight plaintext">{
  identifier: "/users/adam/projects/notifications/app/Views/posts/_post.html.erb",
  count: 3,
  cache_hits: 0
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  identifier: "/users/adam/projects/notifications/app/Views/posts/_post.html.erb",
  count: 3,
  cache_hits: 0
}
'>Copy</button>
</div>
<h4 id="active-record"><a class="anchorlink" href="#active-record">3.4 active record</a></h4><h5 id="sql-active-record"><a class="anchorlink" href="#sql-active-record">3.4.1 sql.active_record</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:sql</code></td>
<td>SQL 語句</td>
</tr>
<tr>
<td><code>:名稱</code></td>
<td>操作名稱</td>
</tr>
<tr>
<td><code>:連線</code></td>
<td>連線物件</td>
</tr>
<tr>
<td><code>:繫結</code></td>
<td>繫結引數</td>
</tr>
<tr>
<td><code>:type_casted_binds</code></td>
<td>型別轉換繫結引數</td>
</tr>
<tr>
<td><code>:statement_name</code></td>
<td>SQL 語句名稱</td>
</tr>
<tr>
<td><code>:快取</code></td>
<td>使用快取查詢時新增<code>true</code>
</td>
</tr>
</tbody>
</table>
<p>資訊。介面卡也會新增自己的資料。</p><div class="code_container">
<pre><code class="highlight plaintext">{
  sql: "SELECT \"posts\".* FROM \"posts\" ",
  name: "Post Load",
  connection: #&lt;ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x00007f9f7a838850&gt;,
  binds: [#&lt;activeModel::attribute::withcastvalue:0x00007fe19d15dc00&gt;],
  type_casted_binds: [11],
  statement_name: nil
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  sql: "SELECT \"posts\".* FROM \"posts\" ",
  name: "Post Load",
  connection: #&lt;ActiveRecord::ConnectionAdapters::SQLite3Adapter:0x00007f9f7a838850&gt;,
  binds: [#&lt;activeModel::attribute::withcastvalue:0x00007fe19d15dc00&gt;],
  type_casted_binds: [11],
  statement_name: nil
}
'>Copy</button>
</div>
<h5 id="active-record"><a class="anchorlink" href="#active-record">3.4.2 例項化.active_record</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:record_count</code></td>
<td>例項化的記錄數</td>
</tr>
<tr>
<td><code>:class_name</code></td>
<td>記錄類</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  record_count: 1,
  class_name: "User"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  record_count: 1,
  class_name: "User"
}
'>Copy</button>
</div>
<h4 id="action"><a class="anchorlink" href="#action">3.5 action 郵寄者</a></h4><h5 id="action-mailer"><a class="anchorlink" href="#action-mailer">3.5.1 投遞。action_mailer</a></h5><p>|鑰匙 |價值 |
| --------------------- | -------------------------------------------------- -- |
| <code>:mailer</code> |郵件程式類的名稱 |
| <code>:message_id</code> |郵件 ID，由 Mail gem 生成 |
| <code>:主題</code> |郵件主題 |
| <code>:to</code> |到郵件地址 |
| <code>:來自</code> |來自郵件地址 |
| <code>:密件抄送</code> |郵件的密件抄送地址 |
| <code>:cc</code> |郵件的抄送地址 |
| <code>:日期</code> |郵件日期 |
| <code>:郵件</code> |郵件的編碼形式 |
| <code>:perform_deliveries</code> |是否執行此訊息的傳遞 |</p><div class="code_container">
<pre><code class="highlight plaintext">{
  mailer: "Notification",
  message_id: "4f5b5491f1774_181b23fc3d4434d38138e5@mba.local.mail",
  subject: "Rails Guides",
  to: ["users@rails.com", "dhh@rails.com"],
  from: ["me@rails.com"],
  date: Sat, 10 Mar 2012 14:18:09 +0100,
  mail: "...", # omitted for brevity
  perform_deliveries: true
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  mailer: "Notification",
  message_id: "4f5b5491f1774_181b23fc3d4434d38138e5@mba.local.mail",
  subject: "Rails Guides",
  to: ["users@rails.com", "dhh@rails.com"],
  from: ["me@rails.com"],
  date: Sat, 10 Mar 2012 14:18:09 +0100,
  mail: "...", # omitted for brevity
  perform_deliveries: true
}
'>Copy</button>
</div>
<h5 id="action-mailer"><a class="anchorlink" href="#action-mailer">3.5.2 程序。action_mailer</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:mailer</code></td>
<td>郵件程式類的名稱</td>
</tr>
<tr>
<td><code>:Action</code></td>
<td>Action</td>
</tr>
<tr>
<td><code>:args</code></td>
<td>論據</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  mailer: "Notification",
  Action: "welcome_email",
  args: []
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  mailer: "Notification",
  Action: "welcome_email",
  args: []
}
'>Copy</button>
</div>
<h4 id="active-support"><a class="anchorlink" href="#active-support">3.6 active support</a></h4><h5 id="cache-read-active-support"><a class="anchorlink" href="#cache-read-active-support">3.6.1 cache_read.active_support</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
<tr>
<td><code>:命中</code></td>
<td>如果此閱讀很受歡迎</td>
</tr>
<tr>
<td><code>:super_operation</code></td>
<td>:fetch 與 <code>#fetch</code> 一起使用時新增</td>
</tr>
</tbody>
</table>
<h5 id="cache-generate-active-support"><a class="anchorlink" href="#cache-generate-active-support">3.6.2 cache_generate.active_support</a></h5><p>此事件僅在使用塊呼叫 <code>#fetch</code> 時使用。</p>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
</tbody>
</table>
<p>資訊。寫入儲存時，傳遞給 fetch 的選項將與有效負載合併</p><div class="code_container">
<pre><code class="highlight plaintext">{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-fetch-hit-active-support"><a class="anchorlink" href="#cache-fetch-hit-active-support">3.6.3 cache_fetch_hit.active_support</a></h5><p>此事件僅在使用塊呼叫 <code>#fetch</code> 時使用。</p>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
</tbody>
</table>
<p>資訊。傳遞給 fetch 的選項將與有效負載合併。</p><div class="code_container">
<pre><code class="highlight plaintext">{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-write-active-support"><a class="anchorlink" href="#cache-write-active-support">3.6.4 cache_write.active_support</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
</tbody>
</table>
<p>資訊。快取儲存可以新增自己的鍵</p><div class="code_container">
<pre><code class="highlight plaintext">{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-delete-active-support"><a class="anchorlink" href="#cache-delete-active-support">3.6.5 cache_delete.active_support</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h5 id="cache-exist-questionmark-active-support"><a class="anchorlink" href="#cache-exist-questionmark-active-support">3.6.6 cache_exist?.active_support</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>店內使用的鑰匙</td>
</tr>
<tr>
<td><code>:商店</code></td>
<td>商店類名稱</td>
</tr>
</tbody>
</table>
<div class="code_container">
<pre><code class="highlight plaintext">{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
</code></pre>
<button class="clipboard-button" data-clipboard-text='{
  key: "name-of-complicated-computation",
  store: "ActiveSupport::Cache::MemCacheStore"
}
'>Copy</button>
</div>
<h4 id=""><a class="anchorlink" href="#">3.7 活動作業</a></h4><h5 id="enqueue-at-active-job"><a class="anchorlink" href="#enqueue-at-active-job">3.7.1 enqueue_at.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
</tbody>
</table>
<h5 id="enqueue-active-job"><a class="anchorlink" href="#enqueue-active-job">3.7.2 enqueue.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
</tbody>
</table>
<h5 id="enqueue-retry-active-job"><a class="anchorlink" href="#enqueue-retry-active-job">3.7.3 enqueue_retry.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:錯誤</code></td>
<td>導致重試的錯誤</td>
</tr>
<tr>
<td><code>:等待</code></td>
<td>重試的延遲</td>
</tr>
</tbody>
</table>
<h5 id="perform-start-active-job"><a class="anchorlink" href="#perform-start-active-job">3.7.4 perform_start.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
</tbody>
</table>
<h5 id="perform-active-job"><a class="anchorlink" href="#perform-active-job">3.7.5 perform.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
</tbody>
</table>
<h5 id="retry-stopped-active-job"><a class="anchorlink" href="#retry-stopped-active-job">3.7.6 retry_stopped.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
<tr>
<td><code>:錯誤</code></td>
<td>導致重試的錯誤</td>
</tr>
</tbody>
</table>
<h5 id="discard-active-job"><a class="anchorlink" href="#discard-active-job">3.7.7 discard.active_job</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:介面卡</code></td>
<td>處理作業的 QueueAdapter 物件</td>
</tr>
<tr>
<td><code>:工作</code></td>
<td>工作物件</td>
</tr>
<tr>
<td><code>:錯誤</code></td>
<td>導致丟棄的錯誤</td>
</tr>
</tbody>
</table>
<h4 id="action"><a class="anchorlink" href="#action">3.8 action 電纜</a></h4><h5 id="perform-action-action-cable"><a class="anchorlink" href="#perform-action-action-cable">3.8.1 perform_action.action_cable</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>通道類名稱</td>
</tr>
<tr>
<td><code>:Action</code></td>
<td>Action</td>
</tr>
<tr>
<td><code>:資料</code></td>
<td>資料雜湊</td>
</tr>
</tbody>
</table>
<h5 id="action-cable"><a class="anchorlink" href="#action-cable">3.8.2 傳輸。action_cable</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>通道類名稱</td>
</tr>
<tr>
<td><code>:資料</code></td>
<td>資料雜湊</td>
</tr>
<tr>
<td><code>:via</code></td>
<td>透過</td>
</tr>
</tbody>
</table>
<h5 id="transmit-subscription-confirmation-action-cable"><a class="anchorlink" href="#transmit-subscription-confirmation-action-cable">3.8.3 transmit_subscription_confirmation.action_cable</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>通道類名稱</td>
</tr>
</tbody>
</table>
<h5 id="transmit-subscription-rejection-action-cable"><a class="anchorlink" href="#transmit-subscription-rejection-action-cable">3.8.4 transmit_subscription_rejection。action_cable</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:channel_class</code></td>
<td>通道類名稱</td>
</tr>
</tbody>
</table>
<h5 id="action-cable"><a class="anchorlink" href="#action-cable">3.8.5 廣播。action_cable</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:廣播</code></td>
<td>一個命名廣播</td>
</tr>
<tr>
<td><code>:訊息</code></td>
<td>訊息雜湊</td>
</tr>
<tr>
<td><code>:編碼器</code></td>
<td>編碼器</td>
</tr>
</tbody>
</table>
<h4 id="active-storage"><a class="anchorlink" href="#active-storage">3.9 active storage</a></h4><h5 id="service-upload-active-storage"><a class="anchorlink" href="#service-upload-active-storage">3.9.1 service_upload.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
<tr>
<td><code>:校驗和</code></td>
<td>校驗和以確保完整性</td>
</tr>
</tbody>
</table>
<h5 id="service-streaming-download-active-storage"><a class="anchorlink" href="#service-streaming-download-active-storage">3.9.2 service_streaming_download.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
</tbody>
</table>
<h5 id="service-download-chunk-active-storage"><a class="anchorlink" href="#service-download-chunk-active-storage">3.9.3 service_download_chunk.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
<tr>
<td><code>:範圍</code></td>
<td>試圖讀取的位元組範圍</td>
</tr>
</tbody>
</table>
<h5 id="service-download-active-storage"><a class="anchorlink" href="#service-download-active-storage">3.9.4 service_download.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
</tbody>
</table>
<h5 id="service-delete-active-storage"><a class="anchorlink" href="#service-delete-active-storage">3.9.5 service_delete.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
</tbody>
</table>
<h5 id="service-delete-prefixed-active-storage"><a class="anchorlink" href="#service-delete-prefixed-active-storage">3.9.6 service_delete_prefixed.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:字首</code></td>
<td>鍵字首</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
</tbody>
</table>
<h5 id="service-exist-active-storage"><a class="anchorlink" href="#service-exist-active-storage">3.9.7 service_exist.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
<tr>
<td><code>:存在</code></td>
<td>檔案或 blob 是否存在</td>
</tr>
</tbody>
</table>
<h5 id="service-url-active-storage"><a class="anchorlink" href="#service-url-active-storage">3.9.8 service_url.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
<tr>
<td><code>:url</code></td>
<td>生成的網址</td>
</tr>
</tbody>
</table>
<h5 id="service-update-metadata-active-storage"><a class="anchorlink" href="#service-update-metadata-active-storage">3.9.9 service_update_metadata.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
<tr>
<td><code>:服務</code></td>
<td>服務名稱</td>
</tr>
<tr>
<td><code>:content_type</code></td>
<td>HTTP 內容型別欄位</td>
</tr>
<tr>
<td><code>:disposition</code></td>
<td>HTTP Content-Disposition field</td>
</tr>
</tbody>
</table>
<div class="info"><p>The only ActiveStorage service that provides this hook so far is GCS.</p></div><h5 id="preview-active-storage"><a class="anchorlink" href="#preview-active-storage">3.9.10 preview.active_storage</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:key</code></td>
<td>安全Token</td>
</tr>
</tbody>
</table>
<h5 id="transform-active-storage"><a class="anchorlink" href="#transform-active-storage">3.9.11 transform.active_storage</a></h5><h5 id="analyze-active-storage"><a class="anchorlink" href="#analyze-active-storage">3.9.12 analyze.active_storage</a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:analyzer</code></td>
<td>Name of analyzer e.g., ffprobe</td>
</tr>
</tbody>
</table>
<h4 id="railties"><a class="anchorlink" href="#railties">3.10 railties</a></h4><h5 id="load-config-initializer-railties"><a class="anchorlink" href="#load-config-initializer-railties">3.10.1 load_config_initializer.railties</a></h5>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:initializer</code></td>
<td>Path to loaded initializer from <code>config/initializers</code>
</td>
</tr>
</tbody>
</table>
<h4 id="rails"><a class="anchorlink" href="#rails">3.11 rails</a></h4><h5 id="deprecation-rails"><a class="anchorlink" href="#deprecation-rails">3.11.1 deprecation.rails</a></h5>
<table>
<thead>
<tr>
<th>鑰匙</th>
<th>價值</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:message</code></td>
<td>The deprecation warning</td>
</tr>
<tr>
<td><code>:callstack</code></td>
<td>Where the deprecation came from</td>
</tr>
</tbody>
</table>
<h3 id="exceptions"><a class="anchorlink" href="#exceptions">4 Exceptions</a></h3><p>If an exception happens during any instrumentation the payload will include
information about it.</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Value</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>:exception</code></td>
<td>An array of two elements. Exception class name and the message</td>
</tr>
<tr>
<td><code>:exception_object</code></td>
<td>The exception object</td>
</tr>
</tbody>
</table>
<h3 id="creating-custom-events"><a class="anchorlink" href="#creating-custom-events">5 Creating custom events</a></h3><p>Adding your own events is easy as well. <code>ActiveSupport::Notifications</code> will take care of
all the heavy lifting for you. Simply call <code>instrument</code> with a <code>name</code>, <code>payload</code> and a block.
The notification will be sent after the block returns. <code>ActiveSupport</code> will generate the start and end times
and add the instrumenter's unique ID. All data passed into the <code>instrument</code> call will make
it into the payload.</p><p>Here's an example:</p><div class="code_container">
<pre><code class="highlight plaintext">ActiveSupport::Notifications.instrument "my.custom.event", this: :data do
  # do your custom stuff here
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.instrument "my.custom.event", this: :data do
  # do your custom stuff here
end
'>Copy</button>
</div>
<p>Now you can listen to this event with:</p><div class="code_container">
<pre><code class="highlight plaintext">ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
'>Copy</button>
</div>
<p>You also have the option to call instrument without passing a block. This lets you leverage the
instrumentation infrastructure for other messaging uses.</p><div class="code_container">
<pre><code class="highlight plaintext">ActiveSupport::Notifications.instrument "my.custom.event", this: :data

ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
</code></pre>
<button class="clipboard-button" data-clipboard-text='ActiveSupport::Notifications.instrument "my.custom.event", this: :data

ActiveSupport::Notifications.subscribe "my.custom.event" do |name, started, finished, unique_id, data|
  puts data.inspect # {:this=&gt;:data}
end
'>Copy</button>
</div>
<p>You should follow Rails conventions when defining your own events. The format is: <code>event.library</code>.
If your application is sending Tweets, you should create an event named <code>tweet.twitter</code>.</p>

        <h3>反饋</h3>
        <p>
          我們鼓勵您幫助提高本指南的質量。
        </p>
        <p>
          如果您發現任何拼寫錯誤或事實錯誤，請貢獻。
          首先，您可以閱讀我們的 <a href="https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#contributing-to-the-rails-documentation">文檔貢獻</a> 部分。
        </p>
        <p>
          您還可能會發現不完整的內容或不是最新的內容。
          請務必為 main 添加任何缺失的文檔。確保檢查
          <a href="https://edgeguides.rubyonrails.org">Edge Guides</a> 先驗證
          如果問題已經在主分支上解決。
          檢查 <a href="ruby_on_rails_guides_guidelines.html">Ruby on Rails 指南指南</a>
          風格和慣例。
        </p>
        <p>
          如果由於某種原因您發現需要修復但無法自行修補的內容，請
          <a href="https://github.com/rails/rails/issues">open an issue</a>。
        </p>
        <p>最後但並非最不重要的是，關於 Ruby on Rails 的任何討論
          <a href="https://discuss.rubyonrails.org/c/rubyonrails-docs">rubyonrails-docs 郵件列表</a> 上的文檔非常受歡迎。
        </p>
      </div>
    </div>
  </div>

  <hr class="hide" />
  <div id="footer">
    <div class="wrapper">
      <p>本作品已獲得<a href="https://creativecommons.org/licenses/by-sa/4.0/">知識共享署名-相同方式共享 4.0 國際</a>許可</p>
<p>“Rails”、“Ruby on Rails”和 Rails 標誌是 David Heinemeier Hansson 的商標。 保留所有權利。</p>
    </div>
  </div>
</body>
</html>
